{% extends 'base.html' %}

{% block content %}
{% if tag %}
<h2 class="mb-3">Posts tagged with "{{ tag.name }}"</h2>
{% endif %}

{% for post in posts %}
<div class="card mb-4 border-0 shadow-sm">
	<div class="card-body p-0">
		<div class="row g-0">
			<div class="col-md-4">
				<div class="ratio ratio-4x3 h-100">
					{% if post.image %}
					<img src="{{ post.image.url }}" class="featured-image-list" alt="{{ post.title }}">
					{% else %}
					<div class="bg-light d-flex align-items-center justify-content-center h-100">
						<span class="text-muted opacity-25">No Image</span>
					</div>
					{% endif %}
				</div>
			</div>
			<div class="col-md-8 p-4 d-flex flex-column">
				<div class="mb-2">
					{% for tag in post.tags.all %}
					<span class="badge bg-primary bg-opacity-10 text-primary fw-normal me-1">{{ tag.name }}</span>
					{% endfor %}
				</div>
				<h2 class="card-title h4 fw-bold">
					<a href="{{ post.get_absolute_url }}" class="text-decoration-none text-dark">
						{{ post.title }}
					</a>
				</h2>
				<div class="text-muted mb-3">
					<small>
						{{ post.publish|date:"M d, Y" }} &bull; {{ post.read_time }} min read
					</small>
				</div>
				<p class="card-text text-muted mb-auto">{{ post.body|safe|striptags|truncatechars:150 }}</p>
				<div class="mt-3">
					<a href="{{ post.get_absolute_url }}" class="btn btn-primary btn-sm px-3">Read more</a>
				</div>
			</div>
		</div>
	</div>
</div>
{% empty %}
<div class="empty-state-ai">
	<div class="glass-alert p-5 text-center">
		<div class="mb-4">
			<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
				class="opacity-50">
				<path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
			</svg>
		</div>
		<h3 class="fw-bold">No direct matches found</h3>
		<p class="text-muted mb-4 small text-uppercase letter-spacing-1">Our neural engine is standing by to help</p>
		<button onclick="sendQuickAction('Tell me about {{ query }}')" class="btn btn-primary px-4 py-2">
			Ask Ding AI about "{{ query }}"
		</button>
	</div>
</div>
{% endfor %}

{% include "pagination.html" with page=posts %}

{% endblock content %}