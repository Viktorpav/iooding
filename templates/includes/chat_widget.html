{% load static %}
<!-- Advanced AI Integration: Sidebar System -->
<div id="ai-system-container">
    <!-- The Edge Trigger -->
    <div id="ai-edge-trigger" onclick="toggleChat()">
        <div class="trigger-glow"></div>
        <div class="trigger-content">
            <img src="{% static 'ai_logo.png' %}" alt="AI" class="trigger-logo">
            <span class="trigger-text">AI ASSISTANT</span>
        </div>
    </div>

    <!-- The Sidebar Panel -->
    <div id="ai-sidebar" class="premium-glass">
        <!-- Suggestion 1: Mobile Bottom Sheet Handle -->
        <div class="mobile-handle d-none"></div>

        <div class="sidebar-inner">
            <div class="sidebar-header">
                <div class="agent-brand">
                    <img src="{% static 'ai_logo.png' %}" alt="AI Agent" class="header-logo">
                    <div class="header-text">
                        <span class="agent-name">Ding Assistant</span>
                        <span class="agent-status"><span class="pulse"></span> Online</span>
                    </div>
                </div>
                <div class="header-actions-top">
                    <button class="action-btn-header" onclick="clearHistory()" title="Clear Conversation">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path
                                d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                        </svg>
                    </button>
                    <button class="close-trigger" onclick="toggleChat()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M15 18l-6-6 6-6" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Suggestion 4: Quick Actions as Scrollable Chips -->
            <div class="quick-actions">
                <button class="quick-action-chip" onclick="sendQuickAction('Summarize the core of this site')">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2.5">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                        <path d="M14 2v6h6" />
                        <path d="M16 13H8" />
                        <path d="M16 17H8" />
                        <path d="M10 9H8" />
                    </svg>
                    Summarize
                </button>
                <button class="quick-action-chip" onclick="sendQuickAction('Show me technical setup insights')">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2.5">
                        <path
                            d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96" />
                        <line x1="12" y1="22.08" x2="12" y2="12" />
                    </svg>
                    Architecture
                </button>
                <button class="quick-action-chip" onclick="sendQuickAction('What is the identity of this AI?')">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2.5">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M12 16v-4" />
                        <path d="M12 8h.01" />
                    </svg>
                    Identity
                </button>
                <button class="quick-action-chip" onclick="sendQuickAction('Latest posts index')">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2.5">
                        <circle cx="12" cy="12" r="10" />
                        <polyline points="12 6 12 12 16 14" />
                    </svg>
                    Latest
                </button>
            </div>

            <div id="chat-messages" class="chat-viewport">
                <!-- Status Badge (Hidden on mobile via CSS) -->
                <div class="ai-status-badge">
                    <span class="badge-icon"></span>
                    <span class="badge-text">Neural Sync Active</span>
                </div>

                <!-- Welcome Message -->
                <div class="ai-msg system-msg">
                    <div class="msg-content">
                        <p>Interface active. Powering high-performance inference. How can I assist with your technical
                            journey today?</p>
                    </div>
                </div>
            </div>

            <div class="sidebar-footer">
                <div class="input-advanced-wrap">
                    <textarea id="ai-user-input" placeholder="Type your technical query..." rows="1"></textarea>
                    <div class="footer-actions">
                        <div class="model-info">
                            <span id="ai-stats-realtime" class="stats-mini"></span>
                        </div>
                        <div class="keyboard-hint">Double Enter to Send</div>
                        <button id="ai-send-btn" onclick="handleSendClick()">
                            <svg class="send-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M5 12h14M12 5l7 7-7 7" />
                            </svg>
                            <svg class="stop-icon" style="display:none;" width="18" height="18" viewBox="0 0 24 24"
                                fill="currentColor" stroke="none">
                                <rect x="4" y="4" width="16" height="16" rx="2" ry="2" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>